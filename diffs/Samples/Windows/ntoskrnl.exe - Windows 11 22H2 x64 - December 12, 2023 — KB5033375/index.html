<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-diffs docs-version-current docs-doc-page docs-doc-id-Samples/Windows/ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">ntoskrnl.exe.x64.10.0.22621.2792-ntoskrnl.exe.x64.10.0.22621.2861 Diff | ghidriff</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://clearbluejar.github.io/ghidriff/img/github-social-ghidriff.png"><meta data-rh="true" name="twitter:image" content="https://clearbluejar.github.io/ghidriff/img/github-social-ghidriff.png"><meta data-rh="true" property="og:url" content="https://clearbluejar.github.io/ghidriff/diffs/Samples/Windows/ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-diffs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-diffs-current"><meta data-rh="true" property="og:title" content="ntoskrnl.exe.x64.10.0.22621.2792-ntoskrnl.exe.x64.10.0.22621.2861 Diff | ghidriff"><meta data-rh="true" name="description" content="- ntoskrnl.exe.x64.10.0.22621.2792-ntoskrnl.exe.x64.10.0.22621.2861 Diff"><meta data-rh="true" property="og:description" content="- ntoskrnl.exe.x64.10.0.22621.2792-ntoskrnl.exe.x64.10.0.22621.2861 Diff"><link data-rh="true" rel="icon" href="/ghidriff/img/fav/favicon.ico"><link data-rh="true" rel="canonical" href="https://clearbluejar.github.io/ghidriff/diffs/Samples/Windows/ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375"><link data-rh="true" rel="alternate" href="https://clearbluejar.github.io/ghidriff/diffs/Samples/Windows/ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375" hreflang="en"><link data-rh="true" rel="alternate" href="https://clearbluejar.github.io/ghidriff/diffs/Samples/Windows/ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5C35JSLCM5"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5C35JSLCM5",{anonymize_ip:!0})</script><link rel="stylesheet" href="/ghidriff/assets/css/styles.e92fc91a.css">
<script src="/ghidriff/assets/js/runtime~main.b8aaf47d.js" defer="defer"></script>
<script src="/ghidriff/assets/js/main.164e4497.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ghidriff/"><div class="navbar__logo"><img src="/ghidriff/img/ghidriff-circle.svg" alt="ghidriff: Ghidra Binary Diffing Engine" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ghidriff/img/ghidriff-circle.svg" alt="ghidriff: Ghidra Binary Diffing Engine" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">ghidriff</b></a><a class="navbar__item navbar__link" href="/ghidriff/docs/ghidriff">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ghidriff/diffs/category/samples">Diffs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/clearbluejar/ghidriff" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/ghidriff/diffs/category/samples">Samples</a><button aria-label="Collapse sidebar category &#x27;Samples&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" tabindex="0" href="/ghidriff/diffs/category/mac-diffs">Mac Diffs</a><button aria-label="Collapse sidebar category &#x27;Mac Diffs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ghidriff/diffs/Samples/Mac/contacts-sample">cf23A-cf23B Diff</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ghidriff/diffs/Samples/Mac/libcorecrypto.dylib-14.2.1-libcorecrypto.dylib-14.3">libcorecrypto.dylib-14.2.1-libcorecrypto.dylib-14.3 Diff</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ghidriff/diffs/category/cves">CVEs</a><button aria-label="Expand sidebar category &#x27;CVEs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/ghidriff/diffs/category/windows">Windows</a><button aria-label="Collapse sidebar category &#x27;Windows&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ghidriff/diffs/Samples/Windows/ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375">ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/ghidriff/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ghidriff/diffs/category/samples"><span itemprop="name">Samples</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/ghidriff/diffs/category/windows"><span itemprop="name">Windows</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>ntoskrnl.exe.x64.10.0.22621.2792-ntoskrnl.exe.x64.10.0.22621.2861 Diff</h1>
<h1>TOC</h1>
<ul>
<li><a href="#ntoskrnlexex64100226212792-ntoskrnlexex64100226212861-diff">ntoskrnl.exe.x64.10.0.22621.2792-ntoskrnl.exe.x64.10.0.22621.2861 Diff</a></li>
<li><a href="#toc">TOC</a></li>
<li><a href="#visual-chart-diff">Visual Chart Diff</a></li>
<li><a href="#metadata">Metadata</a>
<ul>
<li><a href="#ghidra-diff-engine">Ghidra Diff Engine</a>
<ul>
<li><a href="#command-line">Command Line</a>
<ul>
<li><a href="#captured-command-line">Captured Command Line</a></li>
<li><a href="#verbose-args">Verbose Args</a></li>
<li><a href="#download-original-pes">Download Original PEs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#binary-metadata-diff">Binary Metadata Diff</a></li>
<li><a href="#program-options">Program Options</a></li>
<li><a href="#diff-stats">Diff Stats</a></li>
<li><a href="#strings">Strings</a></li>
</ul>
</li>
<li><a href="#deleted">Deleted</a></li>
<li><a href="#added">Added</a></li>
<li><a href="#modified">Modified</a>
<ul>
<li><a href="#kequeryspeculationcontrolinformation">KeQuerySpeculationControlInformation</a>
<ul>
<li><a href="#match-info">Match Info</a></li>
<li><a href="#function-meta-diff">Function Meta Diff</a></li>
<li><a href="#kequeryspeculationcontrolinformation-diff">KeQuerySpeculationControlInformation Diff</a></li>
</ul>
</li>
<li><a href="#micreatefixuprecord">MiCreateFixupRecord</a>
<ul>
<li><a href="#match-info-1">Match Info</a></li>
<li><a href="#function-meta-diff-1">Function Meta Diff</a></li>
<li><a href="#micreatefixuprecord-diff">MiCreateFixupRecord Diff</a></li>
</ul>
</li>
<li><a href="#kisethardwarespeculationcontrolfeatures">KiSetHardwareSpeculationControlFeatures</a>
<ul>
<li><a href="#match-info-2">Match Info</a></li>
<li><a href="#function-meta-diff-2">Function Meta Diff</a></li>
<li><a href="#kisethardwarespeculationcontrolfeatures-diff">KiSetHardwareSpeculationControlFeatures Diff</a></li>
</ul>
</li>
<li><a href="#kidetecthardwarespeccontrolfeatures">KiDetectHardwareSpecControlFeatures</a>
<ul>
<li><a href="#match-info-3">Match Info</a></li>
<li><a href="#function-meta-diff-3">Function Meta Diff</a></li>
<li><a href="#kidetecthardwarespeccontrolfeatures-diff">KiDetectHardwareSpecControlFeatures Diff</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#modified-no-code-changes">Modified (No Code Changes)</a>
<ul>
<li><a href="#mikvarangesort">MiKvaRangeSort</a>
<ul>
<li><a href="#match-info-4">Match Info</a></li>
<li><a href="#function-meta-diff-4">Function Meta Diff</a></li>
<li><a href="#mikvarangesort-calling-diff">MiKvaRangeSort Calling Diff</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1>Visual Chart Diff</h1>
<!-- -->
<!-- -->
<!-- -->
<h1>Metadata</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ghidra-diff-engine">Ghidra Diff Engine<a href="#ghidra-diff-engine" class="hash-link" aria-label="Direct link to Ghidra Diff Engine" title="Direct link to Ghidra Diff Engine">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="command-line">Command Line<a href="#command-line" class="hash-link" aria-label="Direct link to Command Line" title="Direct link to Command Line">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="captured-command-line">Captured Command Line<a href="#captured-command-line" class="hash-link" aria-label="Direct link to Captured Command Line" title="Direct link to Captured Command Line">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ghidriff --project-location ghidra_projects --project-name ghidriff --symbols-path symbols --threaded --log-level DEBUG --file-log-level INFO --log-path ghidriff.log --min-func-len 166 --max-ram-percent 60.0 --max-section-funcs 200 ntoskrnl.exe.x64.10.0.22621.2792 ntoskrnl.exe.x64.10.0.22621.2861</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="verbose-args">Verbose Args<a href="#verbose-args" class="hash-link" aria-label="Direct link to Verbose Args" title="Direct link to Verbose Args">​</a></h4>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Details</summary><div><div class="collapsibleContent_i85q">
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">--old [&#x27;bins/ntoskrnl.exe.x64.10.0.22621.2792&#x27;] --new [[&#x27;bins/ntoskrnl.exe.x64.10.0.22621.2861&#x27;]] --engine VersionTrackingDiff --output-path ghidriffs --summary False --project-location ghidra_projects --project-name ghidriff --symbols-path symbols --threaded True --force-analysis False --force-diff False --no-symbols False --log-level DEBUG --file-log-level INFO --log-path ghidriff.log --va False --min-func-len 166 --max-ram-percent 60.0 --print-flags False --jvm-args None --side-by-side False --max-section-funcs 200 --md-title None</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</div></div></details>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="download-original-pes">Download Original PEs<a href="#download-original-pes" class="hash-link" aria-label="Direct link to Download Original PEs" title="Direct link to Download Original PEs">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://msdl.microsoft.com/download/symbols/ntkrnlmp.exe/45E0905D1047000/ntkrnlmp.exe -O ntkrnlmp.exe.x64.10.0.22621.2792</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">wget https://msdl.microsoft.com/download/symbols/ntkrnlmp.exe/9EEE36DE1047000/ntkrnlmp.exe -O ntkrnlmp.exe.x64.10.0.22621.2861</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="binary-metadata-diff">Binary Metadata Diff<a href="#binary-metadata-diff" class="hash-link" aria-label="Direct link to Binary Metadata Diff" title="Direct link to Binary Metadata Diff">​</a></h2>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token coord">--- ntoskrnl.exe.x64.10.0.22621.2792 Meta</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">+++ ntoskrnl.exe.x64.10.0.22621.2861 Meta</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">@@ -1,44 +1,44 @@</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">Program Name: ntoskrnl.exe.x64.10.0.22621.2792</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">Program Name: ntoskrnl.exe.x64.10.0.22621.2861</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Language ID: x86:LE:64:default (2.14)</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Compiler ID: windows</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Processor: x86</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Endian: Little</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Address Size: 64</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Minimum Address: 140000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Maximum Address: ff0000184f</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"># of Bytes: 17058172</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"># of Bytes: 17058156</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># of Memory Blocks: 42</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"># of Instructions: 2428603</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49"># of Defined Data: 76345</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"># of Instructions: 2428804</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa"># of Defined Data: 76341</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># of Functions: 30553</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># of Symbols: 312846</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># of Data Types: 6213</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"># of Data Type Categories: 581</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Analyzed: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Compiler: visualstudio:unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Created With Ghidra Version: 10.4</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">Date Created: Wed Dec 13 13:10:12 UTC 2023</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">Date Created: Wed Dec 13 13:10:16 UTC 2023</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Executable Format: Portable Executable (PE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">Executable Location: /workspaces/ghidriff/ntoskrnl.exe.x64.10.0.22621.2792</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">Executable MD5: 10ea2e1b94d0c838953cb0f9739e8372</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">Executable SHA256: 98831dafa306900ac2b11f23fe69a789f1232127c653f3e01554c339bcb08365</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">FSRL: file:///workspaces/ghidriff/ntoskrnl.exe.x64.10.0.22621.2792?MD5=10ea2e1b94d0c838953cb0f9739e8372</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">Executable Location: /workspaces/ghidriff/ntoskrnl.exe.x64.10.0.22621.2861</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">Executable MD5: c89e5bac1b50f750ac11431fe7865946</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">Executable SHA256: 0ce15480462e9cd3f7cbf2d44d2e393cf5674ee1d69a3459adfa0e913a7a2aeb</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">FSRL: file:///workspaces/ghidriff/ntoskrnl.exe.x64.10.0.22621.2861?MD5=c89e5bac1b50f750ac11431fe7865946</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PDB Age: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PDB File: ntkrnlmp.pdb</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">PDB GUID: 83330ebc-3601-6c3b-d2b8-1c614ec8187c</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">PDB GUID: 7fcf1ace-660b-3812-3d43-4bb789d5a6e8</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PDB Loaded: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PDB Version: RSDS</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PE Property[CompanyName]: Microsoft Corporation</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PE Property[FileDescription]: NT Kernel &amp; System</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">PE Property[FileVersion]: 10.0.22621.2792 (WinBuild.160101.0800)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">PE Property[FileVersion]: 10.0.22621.2861 (WinBuild.160101.0800)</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PE Property[InternalName]: ntkrnlmp.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PE Property[LegalCopyright]: © Microsoft Corporation. All rights reserved.</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PE Property[OriginalFilename]: ntkrnlmp.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PE Property[ProductName]: Microsoft® Windows® Operating System</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">PE Property[ProductVersion]: 10.0.22621.2792</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">PE Property[ProductVersion]: 10.0.22621.2861</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">PE Property[Translation]: 4b00409</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Preferred Root Namespace Category: </span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">RTTI Found: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Relocatable: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">SectionAlignment: 4096</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">Should Ask To Analyze: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="program-options">Program Options<a href="#program-options" class="hash-link" aria-label="Direct link to Program Options" title="Direct link to Program Options">​</a></h2>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Ghidra ntoskrnl.exe.x64.10.0.22621.2792 Decompiler Options</summary><div><div class="collapsibleContent_i85q">
<!-- -->













<table><thead><tr><th style="text-align:center">Decompiler Option</th><th style="text-align:center">Value</th></tr></thead><tbody><tr><td style="text-align:center">Prototype Evaluation</td><td style="text-align:center">__fastcall</td></tr></tbody></table>
</div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Ghidra ntoskrnl.exe.x64.10.0.22621.2792 Specification extensions Options</summary><div><div class="collapsibleContent_i85q">
<!-- -->

















<table><thead><tr><th style="text-align:center">Specification extensions Option</th><th style="text-align:center">Value</th></tr></thead><tbody><tr><td style="text-align:center">FormatVersion</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">VersionCounter</td><td style="text-align:center">0</td></tr></tbody></table>
</div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Ghidra ntoskrnl.exe.x64.10.0.22621.2792 Analyzers Options</summary><div><div class="collapsibleContent_i85q">
<!-- -->

























































































































































































































































































































































































































































































































<table><thead><tr><th style="text-align:center">Analyzers Option</th><th style="text-align:center">Value</th></tr></thead><tbody><tr><td style="text-align:center">ASCII Strings</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Create Strings Containing Existing Strings</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Create Strings Containing References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Force Model Reload</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">ASCII Strings.Minimum String Length</td><td style="text-align:center">LEN_5</td></tr><tr><td style="text-align:center">ASCII Strings.Model File</td><td style="text-align:center">StringModel.sng</td></tr><tr><td style="text-align:center">ASCII Strings.Require Null Termination for String</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Search Only in Accessible Memory Blocks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.String Start Alignment</td><td style="text-align:center">ALIGN_1</td></tr><tr><td style="text-align:center">ASCII Strings.String end alignment</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">Aggressive Instruction Finder</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Aggressive Instruction Finder.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Apply Data Archives</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Apply Data Archives.Archive Chooser</td><td style="text-align:center">[Auto-Detect]</td></tr><tr><td style="text-align:center">Apply Data Archives.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Apply Data Archives.GDT User File Archive Path</td><td style="text-align:center">None</td></tr><tr><td style="text-align:center">Apply Data Archives.User Project Archive Path</td><td style="text-align:center">None</td></tr><tr><td style="text-align:center">Call Convention ID</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Call Convention ID.Analysis Decompiler Timeout (sec)</td><td style="text-align:center">60</td></tr><tr><td style="text-align:center">Call-Fixup Installer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Condense Filler Bytes</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Condense Filler Bytes.Filler Value</td><td style="text-align:center">Auto</td></tr><tr><td style="text-align:center">Condense Filler Bytes.Minimum number of sequential bytes</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Create Address Tables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Create Address Tables.Allow Offcut References</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Create Address Tables.Auto Label Table</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Create Address Tables.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Create Address Tables.Maxmimum Pointer Distance</td><td style="text-align:center">16777215</td></tr><tr><td style="text-align:center">Create Address Tables.Minimum Pointer Address</td><td style="text-align:center">4132</td></tr><tr><td style="text-align:center">Create Address Tables.Minimum Table Size</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">Create Address Tables.Pointer Alignment</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Create Address Tables.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Create Address Tables.Table Alignment</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">Data Reference</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Address Table Alignment</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Data Reference.Address Table Minimum Size</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">Data Reference.Align End of Strings</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Data Reference.Ascii String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Create Address Tables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Minimum String Length</td><td style="text-align:center">5</td></tr><tr><td style="text-align:center">Data Reference.References to Pointers</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Respect Execute Flag</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Subroutine References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Switch Table References</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Data Reference.Unicode String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Parameter ID</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Analysis Clear Level</td><td style="text-align:center">ANALYSIS</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Analysis Decompiler Timeout (sec)</td><td style="text-align:center">60</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Commit Data Types</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Commit Void Return Values</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Prototype Evaluation</td><td style="text-align:center">__fastcall</td></tr><tr><td style="text-align:center">Decompiler Switch Analysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Switch Analysis.Analysis Decompiler Timeout (sec)</td><td style="text-align:center">60</td></tr><tr><td style="text-align:center">Demangler Microsoft</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Demangler Microsoft.Apply Function Calling Conventions</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Demangler Microsoft.Apply Function Signatures</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Disassemble Entry Points</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Disassemble Entry Points.Respect Execute Flag</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Embedded Media</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Embedded Media.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">External Entry References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function ID</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function ID.Always Apply FID Labels</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Function ID.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function ID.Instruction Count Threshold</td><td style="text-align:center">14.6</td></tr><tr><td style="text-align:center">Function ID.Multiple Match Threshold</td><td style="text-align:center">30.0</td></tr><tr><td style="text-align:center">Function Start Search</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function Start Search.Bookmark Functions</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Function Start Search.Search Data Blocks</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered.Function Non-return Threshold</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered.Repair Flow Damage</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Known</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Known.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">PDB MSDIA</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">PDB MSDIA.Search remote symbol servers</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">PDB Universal</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">PDB Universal.Search remote symbol servers</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Reference</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Address Table Alignment</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Reference.Address Table Minimum Size</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">Reference.Align End of Strings</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Reference.Ascii String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Create Address Tables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Minimum String Length</td><td style="text-align:center">5</td></tr><tr><td style="text-align:center">Reference.References to Pointers</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Respect Execute Flag</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Subroutine References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Switch Table References</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Reference.Unicode String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Scalar Operand References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Scalar Operand References.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Shared Return Calls</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Shared Return Calls.Allow Conditional Jumps</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Shared Return Calls.Assume Contiguous Functions Only</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Stack</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Stack.Create Local Variables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Stack.Create Param Variables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Stack.useNewFunctionStackAnalysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Subroutine References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Subroutine References.Create Thunks Early</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Variadic Function Signature Override</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Variadic Function Signature Override.Create Analysis Bookmarks</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Windows x86 PE Exception Handling</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Windows x86 PE RTTI Analyzer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Windows x86 Thread Environment Block (TEB) Analyzer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Windows x86 Thread Environment Block (TEB) Analyzer.Starting Address of the TEB</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">Windows x86 Thread Environment Block (TEB) Analyzer.Windows OS Version</td><td style="text-align:center">Windows 7</td></tr><tr><td style="text-align:center">WindowsPE x86 Propagate External Parameters</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">WindowsResourceReference</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">WindowsResourceReference.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Create Data from pointer</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Function parameter/return Pointer analysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Max Threads</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Min absolute reference</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Require pointer param data type</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Speculative reference max</td><td style="text-align:center">512</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Speculative reference min</td><td style="text-align:center">1024</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Stored Value Pointer analysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Trust values read from writable memory</td><td style="text-align:center">true</td></tr></tbody></table>
</div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Ghidra ntoskrnl.exe.x64.10.0.22621.2861 Decompiler Options</summary><div><div class="collapsibleContent_i85q">
<!-- -->













<table><thead><tr><th style="text-align:center">Decompiler Option</th><th style="text-align:center">Value</th></tr></thead><tbody><tr><td style="text-align:center">Prototype Evaluation</td><td style="text-align:center">__fastcall</td></tr></tbody></table>
</div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Ghidra ntoskrnl.exe.x64.10.0.22621.2861 Specification extensions Options</summary><div><div class="collapsibleContent_i85q">
<!-- -->

















<table><thead><tr><th style="text-align:center">Specification extensions Option</th><th style="text-align:center">Value</th></tr></thead><tbody><tr><td style="text-align:center">FormatVersion</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">VersionCounter</td><td style="text-align:center">0</td></tr></tbody></table>
</div></div></details>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Ghidra ntoskrnl.exe.x64.10.0.22621.2861 Analyzers Options</summary><div><div class="collapsibleContent_i85q">
<!-- -->

























































































































































































































































































































































































































































































































<table><thead><tr><th style="text-align:center">Analyzers Option</th><th style="text-align:center">Value</th></tr></thead><tbody><tr><td style="text-align:center">ASCII Strings</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Create Strings Containing Existing Strings</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Create Strings Containing References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Force Model Reload</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">ASCII Strings.Minimum String Length</td><td style="text-align:center">LEN_5</td></tr><tr><td style="text-align:center">ASCII Strings.Model File</td><td style="text-align:center">StringModel.sng</td></tr><tr><td style="text-align:center">ASCII Strings.Require Null Termination for String</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.Search Only in Accessible Memory Blocks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">ASCII Strings.String Start Alignment</td><td style="text-align:center">ALIGN_1</td></tr><tr><td style="text-align:center">ASCII Strings.String end alignment</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">Aggressive Instruction Finder</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Aggressive Instruction Finder.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Apply Data Archives</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Apply Data Archives.Archive Chooser</td><td style="text-align:center">[Auto-Detect]</td></tr><tr><td style="text-align:center">Apply Data Archives.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Apply Data Archives.GDT User File Archive Path</td><td style="text-align:center">None</td></tr><tr><td style="text-align:center">Apply Data Archives.User Project Archive Path</td><td style="text-align:center">None</td></tr><tr><td style="text-align:center">Call Convention ID</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Call Convention ID.Analysis Decompiler Timeout (sec)</td><td style="text-align:center">60</td></tr><tr><td style="text-align:center">Call-Fixup Installer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Condense Filler Bytes</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Condense Filler Bytes.Filler Value</td><td style="text-align:center">Auto</td></tr><tr><td style="text-align:center">Condense Filler Bytes.Minimum number of sequential bytes</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Create Address Tables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Create Address Tables.Allow Offcut References</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Create Address Tables.Auto Label Table</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Create Address Tables.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Create Address Tables.Maxmimum Pointer Distance</td><td style="text-align:center">16777215</td></tr><tr><td style="text-align:center">Create Address Tables.Minimum Pointer Address</td><td style="text-align:center">4132</td></tr><tr><td style="text-align:center">Create Address Tables.Minimum Table Size</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">Create Address Tables.Pointer Alignment</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Create Address Tables.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Create Address Tables.Table Alignment</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">Data Reference</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Address Table Alignment</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Data Reference.Address Table Minimum Size</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">Data Reference.Align End of Strings</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Data Reference.Ascii String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Create Address Tables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Minimum String Length</td><td style="text-align:center">5</td></tr><tr><td style="text-align:center">Data Reference.References to Pointers</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Respect Execute Flag</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Subroutine References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Data Reference.Switch Table References</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Data Reference.Unicode String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Parameter ID</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Analysis Clear Level</td><td style="text-align:center">ANALYSIS</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Analysis Decompiler Timeout (sec)</td><td style="text-align:center">60</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Commit Data Types</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Commit Void Return Values</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Decompiler Parameter ID.Prototype Evaluation</td><td style="text-align:center">__fastcall</td></tr><tr><td style="text-align:center">Decompiler Switch Analysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Decompiler Switch Analysis.Analysis Decompiler Timeout (sec)</td><td style="text-align:center">60</td></tr><tr><td style="text-align:center">Demangler Microsoft</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Demangler Microsoft.Apply Function Calling Conventions</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Demangler Microsoft.Apply Function Signatures</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Disassemble Entry Points</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Disassemble Entry Points.Respect Execute Flag</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Embedded Media</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Embedded Media.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">External Entry References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function ID</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function ID.Always Apply FID Labels</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Function ID.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function ID.Instruction Count Threshold</td><td style="text-align:center">14.6</td></tr><tr><td style="text-align:center">Function ID.Multiple Match Threshold</td><td style="text-align:center">30.0</td></tr><tr><td style="text-align:center">Function Start Search</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Function Start Search.Bookmark Functions</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Function Start Search.Search Data Blocks</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered.Function Non-return Threshold</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">Non-Returning Functions - Discovered.Repair Flow Damage</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Known</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Non-Returning Functions - Known.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">PDB MSDIA</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">PDB MSDIA.Search remote symbol servers</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">PDB Universal</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">PDB Universal.Search remote symbol servers</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Reference</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Address Table Alignment</td><td style="text-align:center">1</td></tr><tr><td style="text-align:center">Reference.Address Table Minimum Size</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">Reference.Align End of Strings</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Reference.Ascii String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Create Address Tables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Minimum String Length</td><td style="text-align:center">5</td></tr><tr><td style="text-align:center">Reference.References to Pointers</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Respect Execute Flag</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Subroutine References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Reference.Switch Table References</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Reference.Unicode String References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Scalar Operand References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Scalar Operand References.Relocation Table Guide</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Shared Return Calls</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Shared Return Calls.Allow Conditional Jumps</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Shared Return Calls.Assume Contiguous Functions Only</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Stack</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Stack.Create Local Variables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Stack.Create Param Variables</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Stack.useNewFunctionStackAnalysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Subroutine References</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Subroutine References.Create Thunks Early</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Variadic Function Signature Override</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Variadic Function Signature Override.Create Analysis Bookmarks</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">Windows x86 PE Exception Handling</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Windows x86 PE RTTI Analyzer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Windows x86 Thread Environment Block (TEB) Analyzer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">Windows x86 Thread Environment Block (TEB) Analyzer.Starting Address of the TEB</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">Windows x86 Thread Environment Block (TEB) Analyzer.Windows OS Version</td><td style="text-align:center">Windows 7</td></tr><tr><td style="text-align:center">WindowsPE x86 Propagate External Parameters</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">WindowsResourceReference</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">WindowsResourceReference.Create Analysis Bookmarks</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Create Data from pointer</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Function parameter/return Pointer analysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Max Threads</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Min absolute reference</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Require pointer param data type</td><td style="text-align:center">false</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Speculative reference max</td><td style="text-align:center">512</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Speculative reference min</td><td style="text-align:center">1024</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Stored Value Pointer analysis</td><td style="text-align:center">true</td></tr><tr><td style="text-align:center">x86 Constant Reference Analyzer.Trust values read from writable memory</td><td style="text-align:center">true</td></tr></tbody></table>
</div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="diff-stats">Diff Stats<a href="#diff-stats" class="hash-link" aria-label="Direct link to Diff Stats" title="Direct link to Diff Stats">​</a></h2>





















































































<table><thead><tr><th style="text-align:center">Stat</th><th style="text-align:center">Value</th></tr></thead><tbody><tr><td style="text-align:center">added_funcs_len</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">deleted_funcs_len</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">modified_funcs_len</td><td style="text-align:center">8</td></tr><tr><td style="text-align:center">added_symbols_len</td><td style="text-align:center">11</td></tr><tr><td style="text-align:center">deleted_symbols_len</td><td style="text-align:center">11</td></tr><tr><td style="text-align:center">diff_time</td><td style="text-align:center">48.789085149765015</td></tr><tr><td style="text-align:center">deleted_strings_len</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">added_strings_len</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">match_types</td><td style="text-align:center">Counter({&#x27;SymbolsHash&#x27;: 28092, &#x27;ExactInstructionsFunctionHasher&#x27;: 123, &#x27;ExactBytesFunctionHasher&#x27;: 116, &#x27;ExactMnemonicsFunctionHasher&#x27;: 25})</td></tr><tr><td style="text-align:center">items_to_process</td><td style="text-align:center">30</td></tr><tr><td style="text-align:center">diff_types</td><td style="text-align:center">Counter({&#x27;address&#x27;: 6, &#x27;refcount&#x27;: 6, &#x27;code&#x27;: 4, &#x27;length&#x27;: 4, &#x27;name&#x27;: 4, &#x27;fullname&#x27;: 4, &#x27;sig&#x27;: 4, &#x27;calling&#x27;: 4, &#x27;called&#x27;: 2})</td></tr><tr><td style="text-align:center">unmatched_funcs_len</td><td style="text-align:center">0</td></tr><tr><td style="text-align:center">total_funcs_len</td><td style="text-align:center">61106</td></tr><tr><td style="text-align:center">matched_funcs_len</td><td style="text-align:center">61106</td></tr><tr><td style="text-align:center">matched_funcs_with_code_changes_len</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">matched_funcs_with_non_code_changes_len</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">matched_funcs_no_changes_len</td><td style="text-align:center">61098</td></tr><tr><td style="text-align:center">match_func_similarity_percent</td><td style="text-align:center">99.9869%</td></tr><tr><td style="text-align:center">func_match_overall_percent</td><td style="text-align:center">100.0000%</td></tr></tbody></table>
<!-- -->
<!-- -->
<!-- -->
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="strings">Strings<a href="#strings" class="hash-link" aria-label="Direct link to Strings" title="Direct link to Strings">​</a></h2>
<p><em>No string differences found</em></p>
<h1>Deleted</h1>
<h1>Added</h1>
<h1>Modified</h1>
<p><em>Modified functions contain code changes</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kequeryspeculationcontrolinformation">KeQuerySpeculationControlInformation<a href="#kequeryspeculationcontrolinformation" class="hash-link" aria-label="Direct link to KeQuerySpeculationControlInformation" title="Direct link to KeQuerySpeculationControlInformation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-info">Match Info<a href="#match-info" class="hash-link" aria-label="Direct link to Match Info" title="Direct link to Match Info">​</a></h3>

































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792 - ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">diff_type</td><td style="text-align:center">code,length,address</td></tr><tr><td style="text-align:center">ratio</td><td style="text-align:center">0.83</td></tr><tr><td style="text-align:center">i_ratio</td><td style="text-align:center">0.71</td></tr><tr><td style="text-align:center">m_ratio</td><td style="text-align:center">0.89</td></tr><tr><td style="text-align:center">b_ratio</td><td style="text-align:center">0.9</td></tr><tr><td style="text-align:center">match_types</td><td style="text-align:center">SymbolsHash</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-meta-diff">Function Meta Diff<a href="#function-meta-diff" class="hash-link" aria-label="Direct link to Function Meta Diff" title="Direct link to Function Meta Diff">​</a></h3>






































































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">name</td><td style="text-align:center">KeQuerySpeculationControlInformation</td><td style="text-align:center">KeQuerySpeculationControlInformation</td></tr><tr><td style="text-align:center">fullname</td><td style="text-align:center">KeQuerySpeculationControlInformation</td><td style="text-align:center">KeQuerySpeculationControlInformation</td></tr><tr><td style="text-align:center">refcount</td><td style="text-align:center">2</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center"><code>length</code></td><td style="text-align:center">1136</td><td style="text-align:center">1173</td></tr><tr><td style="text-align:center">called</td><td style="text-align:center">HvlQueryL1tfMitigationInformation<br>KeKvaShadowingActive<br>KiIsFbClearSupported<br>RtlCopyMemory<br>memset</td><td style="text-align:center">HvlQueryL1tfMitigationInformation<br>KeKvaShadowingActive<br>KiIsFbClearSupported<br>RtlCopyMemory<br>memset</td></tr><tr><td style="text-align:center">calling</td><td style="text-align:center">ExpQuerySystemInformation</td><td style="text-align:center">ExpQuerySystemInformation</td></tr><tr><td style="text-align:center">paramcount</td><td style="text-align:center">3</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center"><code>address</code></td><td style="text-align:center">1409727dc</td><td style="text-align:center">1409727bc</td></tr><tr><td style="text-align:center">sig</td><td style="text-align:center">undefined8 __fastcall KeQuerySpeculationControlInformation(void * param_1, uint param_2, uint * param_3)</td><td style="text-align:center">undefined8 __fastcall KeQuerySpeculationControlInformation(void * param_1, uint param_2, uint * param_3)</td></tr><tr><td style="text-align:center">sym_type</td><td style="text-align:center">Function</td><td style="text-align:center">Function</td></tr><tr><td style="text-align:center">sym_source</td><td style="text-align:center">IMPORTED</td><td style="text-align:center">IMPORTED</td></tr><tr><td style="text-align:center">external</td><td style="text-align:center">False</td><td style="text-align:center">False</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kequeryspeculationcontrolinformation-diff">KeQuerySpeculationControlInformation Diff<a href="#kequeryspeculationcontrolinformation-diff" class="hash-link" aria-label="Direct link to KeQuerySpeculationControlInformation Diff" title="Direct link to KeQuerySpeculationControlInformation Diff">​</a></h3>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token coord">--- KeQuerySpeculationControlInformation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">+++ KeQuerySpeculationControlInformation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">@@ -1,130 +1,130 @@</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">undefined8 KeQuerySpeculationControlInformation(void *param_1,uint param_2,uint *param_3)</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong uVar1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  char cVar2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bool bVar3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  int iVar4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined7 extraout_var;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uint uVar5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uint uVar6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong uVar7;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong _Size;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined8 local_res20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  _Size = (ulonglong)param_2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (param_2 &lt; 4) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    *param_3 = 8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    return 0xc0000004;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (7 &lt; param_2) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    param_2 = 8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  *param_3 = param_2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  cVar2 = KiKvaShadow;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar1 = KeFeatureBits2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar6 = (uint)(KiSpeculationFeatures &gt;&gt; 0x20);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_res20._4_4_ = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_res20._0_4_ = uVar6 &gt;&gt; 4 &amp; 1 ^ uVar6 &gt;&gt; 1 &amp; 2 ^ uVar6 &gt;&gt; 1 &amp; 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (((KiSpeculationFeatures &amp; 0x10) != 0) || ((KiSpeculationFeatures &amp; 0x40) != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_res20._0_4_ = (uint)local_res20 | 8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((KiSpeculationFeatures &amp; 4) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_res20._0_4_ = (uint)local_res20 | 0x10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (((KiSpeculationFeatures &gt;&gt; 0x24 &amp; 1) != 0) &amp;&amp; ((KiSpeculationFeatures &amp; 0x2000000000) != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_res20._0_4_ = (uint)local_res20 | 0x2000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar6 = (uint)KiSpeculationFeatures;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_res20._0_4_ =</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       (uVar6 * 4 &amp; 0x80 | (uint)local_res20 ^ uVar6 * 2 &amp; 0x20 ^ uVar6 &amp; 0x40 | 0x100) ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       (uint)(KiSpeculationFeatures &lt;&lt; 2) &amp; 0x200 ^ (uint)(KiSpeculationFeatures &gt;&gt; 0x1c) &amp; 0x400 ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       (uint)(KiSpeculationFeatures &gt;&gt; 0x1c) &amp; 0x800 ^ ~(uint)(KiSpeculationFeatures &lt;&lt; 4) &amp; 0x1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       ^ (uint)(KiSpeculationFeatures &gt;&gt; 0x1b) &amp; 0x4000 ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       (uint)(KiSpeculationFeatures &gt;&gt; 0x1b) &amp; 0x8000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar6 = (uVar6 &amp; 1 | 0x80) &lt;&lt; 0x10 | (uint)(KeFeatureBits2 &lt;&lt; 0x13) &amp; 0x1000000 |</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          (uint)local_res20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((KiKvaShadow == &#x27;\0&#x27;) || (uVar5 = 0x26000000, (KeFeatureBits2 &amp; 8) == 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar5 = 0x24000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar7 = KeFeatureBits2 &amp; 0x8000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (((uVar7 == 0) || (KiDisableTsx == 0)) &amp;&amp; (KiTsxSupported != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if (((KeFeatureBits2 &gt;&gt; 0x10 &amp; 1) == 0) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       ((((byte)KeFeatureBits2 &amp; 0x28) != 8 || (iVar4 = KeKvaShadowingActive(), iVar4 == 0)))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (uVar7 == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        local_res20._0_4_ = uVar6 | uVar5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        local_res20._0_4_ = uVar6 | uVar5 | 0x8000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_res20._0_4_ = uVar6 | uVar5 | 0x10000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_res20._0_4_ = uVar6 | uVar5 | 0x18000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (((uVar1 &gt;&gt; 0x10 &amp; 1) == 0) &amp;&amp; (KiTsxSupportedAtBoot != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar6 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar6 = 0x40000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_res20._0_4_ = (uint)local_res20 | uVar6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  HvlQueryL1tfMitigationInformation((uint *)&amp;local_res20);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar6 = ((uint)(uVar1 &gt;&gt; 0x13) ^ local_res20._4_4_) &amp; 7 ^ local_res20._4_4_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  if (cVar2 == &#x27;\0&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">LAB_0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    uVar5 = 0x410;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  if (cVar2 != &#x27;\0&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    bVar3 = KiIsFbClearSupported();</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar5 = 0x418;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    if ((int)CONCAT71(extraout_var,bVar3) == 0) goto LAB_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    if ((int)CONCAT71(extraout_var,bVar3) != 0) goto LAB_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  uVar5 = 0x410;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">LAB_0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((KiSpeculationFeatures &gt;&gt; 0xf &amp; 1) == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar5 = uVar6 &amp; 0xfffffef7 | uVar5 | 0x200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else if ((((KiSpeculationFeatures &amp; 0x400000000) == 0) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">           ((KiSpeculationFeatures &amp; 0x2000000000) == 0)) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">          ((KiSpeculationFeatures &gt;&gt; 0x2c &amp; 1) == 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if (((KiSpeculationFeatures &amp; 0x800000000) == 0) &amp;&amp; ((KiSpeculationFeatures &gt;&gt; 0x2d &amp; 1) == 0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar5 = uVar6 &amp; 0xfffffff7 | uVar5 | 0x300;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar5 = uVar6 &amp; 0xfffffcf7 | uVar5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar5 = uVar6 &amp; 0xfffffdf7 | uVar5 | 0x100;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar6 = ((uint)(KeFeatureBits2 &gt;&gt; 4) &amp; 1) &lt;&lt; 0xc;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  local_res20 = CONCAT44(uVar6 | uVar5 &amp; 0xffffefff,(uint)local_res20);</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  if ((KiSpeculationFeatures &gt;&gt; 0x15 &amp; 1) == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  if ((KiSpeculationFeatures &amp; 0x200000) == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar6 = uVar6 | uVar5 &amp; 0xfffbefff | 0xa0800;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  else if ((((KiSpeculationFeatures &amp; 0x400000000) == 0) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">           ((KiSpeculationFeatures &amp; 0x2000000000) == 0)) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">          ((KiSpeculationFeatures &gt;&gt; 0x2f &amp; 1) == 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    if (((KiSpeculationFeatures &amp; 0x800000000) == 0) &amp;&amp; ((KiSpeculationFeatures &gt;&gt; 0x30 &amp; 1) == 0))</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      uVar6 = uVar6 | uVar5 &amp; 0xffffefff | 0xe0800;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      uVar6 = uVar6 | uVar5 &amp; 0xfff3efff | 0x20800;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    if ((((KiSpeculationFeatures &amp; 0x400000000) == 0) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">        ((KiSpeculationFeatures &amp; 0x2000000000) == 0)) &amp;&amp; ((KiSpeculationFeatures &gt;&gt; 0x2f &amp; 1) == 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">       ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      if (((KiSpeculationFeatures &amp; 0x800000000) == 0) &amp;&amp; ((KiSpeculationFeatures &gt;&gt; 0x30 &amp; 1) == 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">         ) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">        local_res20 = local_res20 | 0xe080000000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">        local_res20 = local_res20 &amp; 0xfff3ffffffffffff | 0x2080000000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      goto LAB_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar6 = uVar6 | uVar5 &amp; 0xfff7efff | 0x60800;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  local_res20 = CONCAT44(uVar6,(uint)local_res20);</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">LAB_1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  if ((KiSpeculationFeatures &gt;&gt; 0x16 &amp; 1) == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    local_res20 = CONCAT44(uVar6,(uint)local_res20) &amp; 0xffdfffffffffffff | 0x10000000000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    local_res20 = CONCAT44(uVar6,(uint)local_res20) | 0x30000000000000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  memset(param_1,0,_Size);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  RtlCopyMemory(param_1,&amp;local_res20,(ulonglong)param_2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  return 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="micreatefixuprecord">MiCreateFixupRecord<a href="#micreatefixuprecord" class="hash-link" aria-label="Direct link to MiCreateFixupRecord" title="Direct link to MiCreateFixupRecord">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-info-1">Match Info<a href="#match-info-1" class="hash-link" aria-label="Direct link to Match Info" title="Direct link to Match Info">​</a></h3>

































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792 - ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">diff_type</td><td style="text-align:center">code,refcount,length</td></tr><tr><td style="text-align:center">ratio</td><td style="text-align:center">0.24</td></tr><tr><td style="text-align:center">i_ratio</td><td style="text-align:center">0.48</td></tr><tr><td style="text-align:center">m_ratio</td><td style="text-align:center">0.69</td></tr><tr><td style="text-align:center">b_ratio</td><td style="text-align:center">0.88</td></tr><tr><td style="text-align:center">match_types</td><td style="text-align:center">SymbolsHash</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-meta-diff-1">Function Meta Diff<a href="#function-meta-diff-1" class="hash-link" aria-label="Direct link to Function Meta Diff" title="Direct link to Function Meta Diff">​</a></h3>






































































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">name</td><td style="text-align:center">MiCreateFixupRecord</td><td style="text-align:center">MiCreateFixupRecord</td></tr><tr><td style="text-align:center">fullname</td><td style="text-align:center">MiCreateFixupRecord</td><td style="text-align:center">MiCreateFixupRecord</td></tr><tr><td style="text-align:center"><code>refcount</code></td><td style="text-align:center">3</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center"><code>length</code></td><td style="text-align:center">335</td><td style="text-align:center">306</td></tr><tr><td style="text-align:center">called</td><td style="text-align:center">MiAllocatePool</td><td style="text-align:center">MiAllocatePool</td></tr><tr><td style="text-align:center">calling</td><td style="text-align:center">MiScanRelocationPage</td><td style="text-align:center">MiScanRelocationPage</td></tr><tr><td style="text-align:center">paramcount</td><td style="text-align:center">7</td><td style="text-align:center">7</td></tr><tr><td style="text-align:center">address</td><td style="text-align:center">14083f464</td><td style="text-align:center">14083f464</td></tr><tr><td style="text-align:center">sig</td><td style="text-align:center">undefined8 __fastcall MiCreateFixupRecord(longlong * param_1, longlong param_2, uint param_3, int param_4, int param_5, ushort * param_6, longlong * param_7)</td><td style="text-align:center">undefined8 __fastcall MiCreateFixupRecord(longlong * param_1, longlong param_2, uint param_3, int param_4, int param_5, ushort * param_6, longlong * param_7)</td></tr><tr><td style="text-align:center">sym_type</td><td style="text-align:center">Function</td><td style="text-align:center">Function</td></tr><tr><td style="text-align:center">sym_source</td><td style="text-align:center">IMPORTED</td><td style="text-align:center">IMPORTED</td></tr><tr><td style="text-align:center">external</td><td style="text-align:center">False</td><td style="text-align:center">False</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="micreatefixuprecord-diff">MiCreateFixupRecord Diff<a href="#micreatefixuprecord-diff" class="hash-link" aria-label="Direct link to MiCreateFixupRecord Diff" title="Direct link to MiCreateFixupRecord Diff">​</a></h3>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token coord">--- MiCreateFixupRecord</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">+++ MiCreateFixupRecord</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">@@ -1,53 +1,55 @@</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">undefined8</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">MiCreateFixupRecord(longlong *param_1,longlong param_2,uint param_3,int param_4,int param_5,</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">                   ushort *param_6,longlong *param_7)</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong *puVar1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ushort uVar2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  longlong *plVar3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  undefined8 uVar4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  ulonglong local_28;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  undefined8 uVar3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  longlong *plVar4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  ulonglong local_res8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  local_28 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  uVar2 = *param_6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  if ((param_3 &amp; 0xfff) &lt; 0x1000U - param_4) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    if (*(uint *)(*param_1 + 8) &lt;= param_3 + 0x1000 &gt;&gt; 0xc) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      return 0xc0000005;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    if (param_5 == 4) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      local_28 = (ulonglong)*(uint *)((ulonglong)param_3 + param_2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  if (param_3 + 0x1000 &gt;&gt; 0xc &lt; *(uint *)(*param_1 + 8)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    local_res8 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    uVar2 = *param_6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    if ((param_3 &amp; 0xfff) &lt; 0x1000U - param_4) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      if (param_5 == 4) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        local_res8 = (ulonglong)*(uint *)((ulonglong)param_3 + param_2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        local_res8 = *(ulonglong *)((ulonglong)param_3 + param_2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      local_28 = *(ulonglong *)((ulonglong)param_3 + param_2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      *param_6 = uVar2 &amp; 0xfff;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    plVar4 = (longlong *)MiAllocatePool(0x100,0x20,0x72466d4d);</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    if (plVar4 == (longlong *)0x0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      uVar3 = 0xc000009a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      *(ushort *)(plVar4 + 2) = uVar2 &gt;&gt; 0xc;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      *(uint *)((longlong)plVar4 + 0xc) = param_3 + param_5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      if ((param_3 &amp; 0xfff) &lt; 0x1000U - param_4) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        *(uint *)(plVar4 + 1) = param_3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        plVar4[3] = local_res8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        puVar1 = (ulonglong *)(*param_7 + (ulonglong)(param_3 &gt;&gt; 0xc) * 8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        *puVar1 = *puVar1 | 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">        *(uint *)(plVar4 + 1) = (param_3 &amp; 0xfffff000) + 0x1000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      puVar1 = (ulonglong *)(*param_7 + (ulonglong)(*(uint *)((longlong)plVar4 + 0xc) &gt;&gt; 0xc) * 8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      *puVar1 = *puVar1 | 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      *plVar4 = param_7[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      param_7[2] = (longlong)plVar4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">      uVar3 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    *param_6 = uVar2 &amp; 0xfff;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    uVar3 = 0xc0000005;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  plVar3 = (longlong *)MiAllocatePool(0x100,0x20,0x72466d4d);</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  if (plVar3 == (longlong *)0x0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    uVar4 = 0xc000009a;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    *(ushort *)(plVar3 + 2) = uVar2 &gt;&gt; 0xc;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    *(uint *)((longlong)plVar3 + 0xc) = param_3 + param_5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    if ((param_3 &amp; 0xfff) &lt; 0x1000U - param_4) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      *(uint *)(plVar3 + 1) = param_3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      plVar3[3] = local_28;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      puVar1 = (ulonglong *)(*param_7 + (ulonglong)(param_3 &gt;&gt; 0xc) * 8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      *puVar1 = *puVar1 | 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">      *(uint *)(plVar3 + 1) = (param_3 &amp; 0xfffff000) + 0x1000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    puVar1 = (ulonglong *)(*param_7 + (ulonglong)(*(uint *)((longlong)plVar3 + 0xc) &gt;&gt; 0xc) * 8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    *puVar1 = *puVar1 | 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    *plVar3 = param_7[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    param_7[2] = (longlong)plVar3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    uVar4 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">  return uVar4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  return uVar3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kisethardwarespeculationcontrolfeatures">KiSetHardwareSpeculationControlFeatures<a href="#kisethardwarespeculationcontrolfeatures" class="hash-link" aria-label="Direct link to KiSetHardwareSpeculationControlFeatures" title="Direct link to KiSetHardwareSpeculationControlFeatures">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-info-2">Match Info<a href="#match-info-2" class="hash-link" aria-label="Direct link to Match Info" title="Direct link to Match Info">​</a></h3>

































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792 - ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">diff_type</td><td style="text-align:center">code,refcount,length</td></tr><tr><td style="text-align:center">ratio</td><td style="text-align:center">0.89</td></tr><tr><td style="text-align:center">i_ratio</td><td style="text-align:center">0.57</td></tr><tr><td style="text-align:center">m_ratio</td><td style="text-align:center">0.75</td></tr><tr><td style="text-align:center">b_ratio</td><td style="text-align:center">0.92</td></tr><tr><td style="text-align:center">match_types</td><td style="text-align:center">SymbolsHash</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-meta-diff-2">Function Meta Diff<a href="#function-meta-diff-2" class="hash-link" aria-label="Direct link to Function Meta Diff" title="Direct link to Function Meta Diff">​</a></h3>






































































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">name</td><td style="text-align:center">KiSetHardwareSpeculationControlFeatures</td><td style="text-align:center">KiSetHardwareSpeculationControlFeatures</td></tr><tr><td style="text-align:center">fullname</td><td style="text-align:center">KiSetHardwareSpeculationControlFeatures</td><td style="text-align:center">KiSetHardwareSpeculationControlFeatures</td></tr><tr><td style="text-align:center"><code>refcount</code></td><td style="text-align:center">3</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center"><code>length</code></td><td style="text-align:center">232</td><td style="text-align:center">233</td></tr><tr><td style="text-align:center">called</td><td style="text-align:center">KeBugCheckEx<br>KiDetectHardwareSpecControlFeatures</td><td style="text-align:center">KeBugCheckEx<br>KiDetectHardwareSpecControlFeatures</td></tr><tr><td style="text-align:center">calling</td><td style="text-align:center">KiInitializeKernel</td><td style="text-align:center">KiInitializeKernel</td></tr><tr><td style="text-align:center">paramcount</td><td style="text-align:center">4</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center">address</td><td style="text-align:center">1403816cc</td><td style="text-align:center">1403816cc</td></tr><tr><td style="text-align:center">sig</td><td style="text-align:center">undefined __fastcall KiSetHardwareSpeculationControlFeatures(longlong param_1, undefined8 param_2, ulonglong param_3, longlong param_4)</td><td style="text-align:center">undefined __fastcall KiSetHardwareSpeculationControlFeatures(longlong param_1, undefined8 param_2, ulonglong param_3, longlong param_4)</td></tr><tr><td style="text-align:center">sym_type</td><td style="text-align:center">Function</td><td style="text-align:center">Function</td></tr><tr><td style="text-align:center">sym_source</td><td style="text-align:center">IMPORTED</td><td style="text-align:center">IMPORTED</td></tr><tr><td style="text-align:center">external</td><td style="text-align:center">False</td><td style="text-align:center">False</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kisethardwarespeculationcontrolfeatures-diff">KiSetHardwareSpeculationControlFeatures Diff<a href="#kisethardwarespeculationcontrolfeatures-diff" class="hash-link" aria-label="Direct link to KiSetHardwareSpeculationControlFeatures Diff" title="Direct link to KiSetHardwareSpeculationControlFeatures Diff">​</a></h3>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token coord">--- KiSetHardwareSpeculationControlFeatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">+++ KiSetHardwareSpeculationControlFeatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">@@ -1,45 +1,48 @@</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">/* WARNING: Globals starting with &#x27;_&#x27; overlap smaller symbols at the same address */</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">void KiSetHardwareSpeculationControlFeatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">               (longlong param_1,undefined8 param_2,ulonglong param_3,longlong param_4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  byte *pbVar1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined8 uVar2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong in_RDX;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  char local_res8 [32];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined local_28 [16];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined8 local_18;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_res8[0] = &#x27;\0&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_18 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_28 = ZEXT816(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar2 = KiDetectHardwareSpecControlFeatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">                    (param_1,in_RDX,(undefined4 *)local_28,(longlong)local_res8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  pbVar1 = (byte *)(param_1 + 0xf9);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((local_28 &amp; (undefined  [16])0x20) != (undefined  [16])0x0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    *pbVar1 = *pbVar1 | 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (KiKernelCetEnabled != &#x27;\0&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    *pbVar1 = *pbVar1 | 8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (*(int *)(param_1 + 0x24) == 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    KiSpeculationFeatures = KiSpeculationFeatures &amp; 0xffffffff00000000 | local_28._0_8_ &amp; 0xffffffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    ;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    _DAT_0 = local_28._8_4_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    KiSsbdMsr = local_28._8_4_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    DAT_1 = local_18;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    _KiSsbdBit = local_18;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    KiSsbdMsr = local_28._8_4_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    _DAT_0 = KiSsbdMsr;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    DAT_1 = _KiSsbdBit;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    KiCpu0HardwareFlags = local_28._0_4_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else if ((ulonglong)KiCpu0HardwareFlags != (local_28._0_8_ &amp; 0xffffffff)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">                    /* WARNING: Subroutine does not return */</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    KeBugCheckEx(uVar2,param_2,param_3,param_4,(ushort *)0x0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (local_res8[0] != &#x27;\0&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    KiMicrocodeTrackerEnabled = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  if (((ulonglong)local_28._0_8_ &gt;&gt; 0x16 &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    *(byte *)(param_1 + 0xf8) = *(byte *)(param_1 + 0xf8) | 0x80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="kidetecthardwarespeccontrolfeatures">KiDetectHardwareSpecControlFeatures<a href="#kidetecthardwarespeccontrolfeatures" class="hash-link" aria-label="Direct link to KiDetectHardwareSpecControlFeatures" title="Direct link to KiDetectHardwareSpecControlFeatures">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-info-3">Match Info<a href="#match-info-3" class="hash-link" aria-label="Direct link to Match Info" title="Direct link to Match Info">​</a></h3>

































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792 - ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">diff_type</td><td style="text-align:center">code,length,address</td></tr><tr><td style="text-align:center">ratio</td><td style="text-align:center">0.94</td></tr><tr><td style="text-align:center">i_ratio</td><td style="text-align:center">0.71</td></tr><tr><td style="text-align:center">m_ratio</td><td style="text-align:center">0.99</td></tr><tr><td style="text-align:center">b_ratio</td><td style="text-align:center">0.89</td></tr><tr><td style="text-align:center">match_types</td><td style="text-align:center">SymbolsHash</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-meta-diff-3">Function Meta Diff<a href="#function-meta-diff-3" class="hash-link" aria-label="Direct link to Function Meta Diff" title="Direct link to Function Meta Diff">​</a></h3>






































































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">name</td><td style="text-align:center">KiDetectHardwareSpecControlFeatures</td><td style="text-align:center">KiDetectHardwareSpecControlFeatures</td></tr><tr><td style="text-align:center">fullname</td><td style="text-align:center">KiDetectHardwareSpecControlFeatures</td><td style="text-align:center">KiDetectHardwareSpecControlFeatures</td></tr><tr><td style="text-align:center">refcount</td><td style="text-align:center">4</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center"><code>length</code></td><td style="text-align:center">947</td><td style="text-align:center">961</td></tr><tr><td style="text-align:center">called</td><td style="text-align:center">HviGetEnlightenmentInformation<br>HviGetHypervisorFeatures<br>HviIsAnyHypervisorPresent<br>HviIsHypervisorMicrosoftCompatible<br>KiIsBranchConfusionPresent<br>KiIsSrsoPresent<br>__security_check_cookie</td><td style="text-align:center">HviGetEnlightenmentInformation<br>HviGetHypervisorFeatures<br>HviIsAnyHypervisorPresent<br>HviIsHypervisorMicrosoftCompatible<br>KiIsBranchConfusionPresent<br>KiIsSrsoPresent<br>__security_check_cookie</td></tr><tr><td style="text-align:center">calling</td><td style="text-align:center">KiDetermineRetpolineEnablement<br>KiIsKvaShadowNeededForBranchConfusion<br>KiSetHardwareSpeculationControlFeatures</td><td style="text-align:center">KiDetermineRetpolineEnablement<br>KiIsKvaShadowNeededForBranchConfusion<br>KiSetHardwareSpeculationControlFeatures</td></tr><tr><td style="text-align:center">paramcount</td><td style="text-align:center">4</td><td style="text-align:center">4</td></tr><tr><td style="text-align:center"><code>address</code></td><td style="text-align:center">1403822ec</td><td style="text-align:center">14038235c</td></tr><tr><td style="text-align:center">sig</td><td style="text-align:center">undefined __fastcall KiDetectHardwareSpecControlFeatures(longlong param_1, ulonglong param_2, undefined4 * param_3, longlong param_4)</td><td style="text-align:center">undefined __fastcall KiDetectHardwareSpecControlFeatures(longlong param_1, ulonglong param_2, undefined4 * param_3, longlong param_4)</td></tr><tr><td style="text-align:center">sym_type</td><td style="text-align:center">Function</td><td style="text-align:center">Function</td></tr><tr><td style="text-align:center">sym_source</td><td style="text-align:center">IMPORTED</td><td style="text-align:center">IMPORTED</td></tr><tr><td style="text-align:center">external</td><td style="text-align:center">False</td><td style="text-align:center">False</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="kidetecthardwarespeccontrolfeatures-diff">KiDetectHardwareSpecControlFeatures Diff<a href="#kidetecthardwarespeccontrolfeatures-diff" class="hash-link" aria-label="Direct link to KiDetectHardwareSpecControlFeatures Diff" title="Direct link to KiDetectHardwareSpecControlFeatures Diff">​</a></h3>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token coord">--- KiDetectHardwareSpecControlFeatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">+++ KiDetectHardwareSpecControlFeatures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">@@ -1,240 +1,244 @@</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">/* WARNING: Removing unreachable block (ram,0x0001403823fa) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">/* WARNING: Removing unreachable block (ram,0x0001403823e1) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">/* WARNING: Removing unreachable block (ram,0x000140382372) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">/* WARNING: Removing unreachable block (ram,0x00014038233a) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">/* WARNING: Removing unreachable block (ram,0x00014038246a) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">/* WARNING: Removing unreachable block (ram,0x000140382451) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">/* WARNING: Removing unreachable block (ram,0x0001403823e2) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">/* WARNING: Removing unreachable block (ram,0x0001403823aa) */</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">void KiDetectHardwareSpecControlFeatures</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">               (longlong param_1,ulonglong param_2,undefined4 *param_3,longlong param_4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  char cVar1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  byte bVar2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uint *puVar3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined8 *puVar4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined4 *puVar5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bool bVar6;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined auVar7 [16];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  char cVar8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uint uVar9;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined7 extraout_var;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bool bVar12;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bool bVar13;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bool bVar14;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined auStack_a8 [32];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined8 local_88;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined4 uStack_80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined4 uStack_7c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined8 local_78;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined4 *local_70;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined local_68 [4];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined auStack_64 [8];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined4 uStack_5c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  undefined local_58 [16];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  ulonglong local_48;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_48 = __security_cookie ^ (ulonglong)auStack_a8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  cVar1 = *(char *)(param_1 + 0x8d);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar10 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uStack_7c = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bVar2 = *(byte *)(param_1 + 0x43);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_88 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  puVar3 = (uint *)cpuid_basic_info(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uStack_80 = 0x48;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bVar13 = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_78 = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bVar12 = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  auVar7._4_4_ = puVar3[3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  auVar7._0_4_ = puVar3[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  auVar7._8_4_ = puVar3[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  auVar7._12_4_ = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  _local_68 = auVar7 &lt;&lt; 0x20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_58 = ZEXT816(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (*puVar3 &lt; 7) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar9 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    puVar4 = (undefined8 *)cpuid_Extended_Feature_Enumeration_info(7);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar9 = *(uint *)(puVar4 + 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    auStack_64._4_4_ = *(undefined4 *)((longlong)puVar4 + 0xc);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    _local_68 = *puVar4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uStack_5c = puVar3[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0x1d &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar11 = rdmsr(0x10a);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar12 = (uVar11 &amp; 2) != 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (bVar12) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uVar10 = 0x201;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        local_88 = 0x201;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = (uVar11 &amp; 0x10) != 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (bVar13) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uVar10 = uVar10 | 0x100;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = bVar13 || bVar12;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if ((uVar11 &amp; 4) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uVar10 = uVar10 | 0x200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        bVar13 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (cVar1 == &#x27;\x01&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    puVar3 = (uint *)cpuid(0x80000000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    auStack_64._0_4_ = puVar3[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    auStack_64._4_4_ = puVar3[3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uStack_5c = puVar3[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if (*puVar3 &lt; 0x80000008) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar9 = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      puVar5 = (undefined4 *)cpuid(0x80000008);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar9 = puVar5[1];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_68 = (undefined  [4])*puVar5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      auStack_64._4_4_ = puVar5[3];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uStack_5c = puVar5[2];</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0xc &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0xe &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0xf &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x40;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0x18 &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0x1a &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x180;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((local_88 &amp; 0x80) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">LAB_0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0x1a &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x14;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &gt;&gt; 0x1b &amp; 1) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x44;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar13 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((int)uVar9 &lt; 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      goto LAB_0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (((param_2 &amp; 1) != 0) || (KiKvaShadowMode == 1)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar10 = uVar10 | 0x20;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((cVar1 == &#x27;\x02&#x27;) &amp;&amp; (*(char *)(param_1 + 0x40) == &#x27;\x06&#x27;)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((((byte)(bVar2 - 0x4e) &lt; 0x1a) &amp;&amp; ((0x3010081U &gt;&gt; (bVar2 - 0x4e &amp; 0x1f) &amp; 1) != 0)) ||</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       ((bVar2 == 0x8e || (bVar2 == 0x9e)))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if (((byte)(bVar2 - 0x37) &lt; 0x3f) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       ((0x4080404800680001U &gt;&gt; ((ulonglong)(byte)(bVar2 - 0x37) &amp; 0x3f) &amp; 1) != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar10 | 0x200;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar11 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_70 = param_3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (((local_88 &amp; 0x10) == 0) || ((local_88 &amp; 4) == 0)) goto LAB_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bVar6 = true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  cVar8 = HviIsHypervisorMicrosoftCompatible();</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (cVar8 == &#x27;\0&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    cVar8 = HviIsAnyHypervisorPresent();</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    bVar14 = cVar8 == &#x27;\0&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">LAB_2:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if (!bVar14) goto LAB_3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    bVar6 = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">LAB_4:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar9 = *(uint *)(param_1 + 0x6cc);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((uVar9 &amp; 2) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar11 = uVar10 | 0x400;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar10 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if (((uVar9 &amp; 4) != 0) &amp;&amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">       (uVar10 = uVar11 | 0x800, local_88 = uVar10, (KiFeatureSettings &amp; 0x4000) != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      uVar10 = uVar11 | 0x801;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      local_88 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if (cVar1 == &#x27;\x02&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      if (((!bVar6) &amp;&amp; (!bVar12)) || (uVar11 = uVar10, (uVar9 &amp; 3) != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        uVar11 = uVar10 | 0x1000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">        local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      goto LAB_1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    HviGetEnlightenmentInformation((undefined8 *)local_58);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    _local_68 = ZEXT816(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    HviGetHypervisorFeatures((undefined8 *)local_68);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((_local_68 &amp; (undefined  [16])0x100000000000) != (undefined  [16])0x0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      bVar14 = (local_58 &amp; (undefined  [16])0x1000) == (undefined  [16])0x0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">      goto LAB_2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">LAB_3:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    if ((KiFeatureSettings &amp; 0x8000) != 0) goto LAB_4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar11 = uVar10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((cVar1 == &#x27;\x01&#x27;) &amp;&amp; (uVar11 = uVar10 | 0x1000, local_88 = uVar11, (uVar10 &amp; 0x40) != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar11 = uVar10 | 0x5000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">LAB_1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (((KeFeatureBits2 &amp; 0x20000) != 0) &amp;&amp; ((KiFeatureSettings &amp; 0x400000) == 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar11 = uVar11 | 0x2000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  bVar12 = KiIsBranchConfusionPresent(param_1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((int)CONCAT71(extraout_var,bVar12) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar11 = uVar11 | 0x8000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((cVar1 != &#x27;\x01&#x27;) || ((KeFeatureBits2 &amp; 0x2000000) != 0)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar11 = uVar11 | 8;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if ((KiFeatureSettings &amp; 0x10000) != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    uVar11 = uVar11 &amp; 0xfffffffffffff7fe;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  uVar9 = KiIsSrsoPresent(param_1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (uVar9 != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">    local_88 = uVar11 | 0x200000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    uVar11 = uVar11 | 0x200000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    local_88 = uVar11;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">  if (cVar1 == &#x27;\x01&#x27;) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">    local_88 = uVar11 | 0x400000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token inserted-sign inserted line" style="color:#36acaa"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  *local_70 = (undefined4)local_88;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_70[1] = local_88._4_4_;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_70[2] = uStack_80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  local_70[3] = uStack_7c;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  *(undefined8 *)(local_70 + 4) = local_78;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  if (param_4 != 0) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">    *(bool *)param_4 = bVar13;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  __security_check_cookie(local_48 ^ (ulonglong)auStack_a8);</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">  return;</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line"></span><span class="token unchanged prefix unchanged"> </span><span class="token unchanged line"></span><br></span><span class="token-line" style="color:#393A34"><span class="token unchanged line" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Modified (No Code Changes)</h1>
<p><em>Slightly modified functions have no code changes, rather differnces in:</em></p>
<ul>
<li>refcount</li>
<li>length</li>
<li>called</li>
<li>calling</li>
<li>name</li>
<li>fullname</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="mikvarangesort">MiKvaRangeSort<a href="#mikvarangesort" class="hash-link" aria-label="Direct link to MiKvaRangeSort" title="Direct link to MiKvaRangeSort">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="match-info-4">Match Info<a href="#match-info-4" class="hash-link" aria-label="Direct link to Match Info" title="Direct link to Match Info">​</a></h3>

































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792 - ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center">diff_type</td><td style="text-align:center">name,fullname,refcount,sig,address,calling</td></tr><tr><td style="text-align:center">ratio</td><td style="text-align:center">1.0</td></tr><tr><td style="text-align:center">i_ratio</td><td style="text-align:center">0.9</td></tr><tr><td style="text-align:center">m_ratio</td><td style="text-align:center">1.0</td></tr><tr><td style="text-align:center">b_ratio</td><td style="text-align:center">1.0</td></tr><tr><td style="text-align:center">match_types</td><td style="text-align:center">ExactMnemonicsFunctionHasher</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="function-meta-diff-4">Function Meta Diff<a href="#function-meta-diff-4" class="hash-link" aria-label="Direct link to Function Meta Diff" title="Direct link to Function Meta Diff">​</a></h3>






































































<table><thead><tr><th style="text-align:center">Key</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2792</th><th style="text-align:center">ntoskrnl.exe.x64.10.0.22621.2861</th></tr></thead><tbody><tr><td style="text-align:center"><code>name</code></td><td style="text-align:center">MiKvaRangeSort</td><td style="text-align:center">FUN_1403e12e0</td></tr><tr><td style="text-align:center"><code>fullname</code></td><td style="text-align:center">MiKvaRangeSort</td><td style="text-align:center">FUN_1403e12e0</td></tr><tr><td style="text-align:center"><code>refcount</code></td><td style="text-align:center">4</td><td style="text-align:center">3</td></tr><tr><td style="text-align:center">length</td><td style="text-align:center">24</td><td style="text-align:center">24</td></tr><tr><td style="text-align:center">called</td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><code>calling</code></td><td style="text-align:center">HalpChannelInitializeStaticConfiguration<br>VslInitializeSecureKernelCfg</td><td style="text-align:center">FUN_1403e12b0</td></tr><tr><td style="text-align:center">paramcount</td><td style="text-align:center">2</td><td style="text-align:center">2</td></tr><tr><td style="text-align:center"><code>address</code></td><td style="text-align:center">140b90ba0</td><td style="text-align:center">1403e12e0</td></tr><tr><td style="text-align:center"><code>sig</code></td><td style="text-align:center">ulonglong __fastcall MiKvaRangeSort(ulonglong * param_1, ulonglong * param_2)</td><td style="text-align:center">ulonglong __fastcall FUN_1403e12e0(ulonglong * param_1, ulonglong * param_2)</td></tr><tr><td style="text-align:center">sym_type</td><td style="text-align:center">Function</td><td style="text-align:center">Function</td></tr><tr><td style="text-align:center">sym_source</td><td style="text-align:center">IMPORTED</td><td style="text-align:center">DEFAULT</td></tr><tr><td style="text-align:center">external</td><td style="text-align:center">False</td><td style="text-align:center">False</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mikvarangesort-calling-diff">MiKvaRangeSort Calling Diff<a href="#mikvarangesort-calling-diff" class="hash-link" aria-label="Direct link to MiKvaRangeSort Calling Diff" title="Direct link to MiKvaRangeSort Calling Diff">​</a></h3>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token coord">--- MiKvaRangeSort calling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">+++ FUN_1403e12e0 calling</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token coord">@@ -1,2 +1 @@</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">HalpChannelInitializeStaticConfiguration</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token deleted-sign deleted prefix deleted" style="color:#d73a49">-</span><span class="token deleted-sign deleted line" style="color:#d73a49">VslInitializeSecureKernelCfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token deleted-sign deleted line" style="color:#d73a49"></span><span class="token inserted-sign inserted prefix inserted" style="color:#36acaa">+</span><span class="token inserted-sign inserted line" style="color:#36acaa">FUN_1403e12b0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><sub>Generated with <code>ghidriff</code> version: 0.5.1 on 2023-12-13T16:46:33</sub></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/clearbluejar/ghidriff/tree/main/www/diffs/diffs/Samples/Windows/ntoskrnl.exe - Windows 11 22H2 x64 - December 12, 2023 — KB5033375.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/ghidriff/diffs/category/windows"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Windows</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ghidra-diff-engine" class="table-of-contents__link toc-highlight">Ghidra Diff Engine</a><ul><li><a href="#command-line" class="table-of-contents__link toc-highlight">Command Line</a></li></ul></li><li><a href="#binary-metadata-diff" class="table-of-contents__link toc-highlight">Binary Metadata Diff</a></li><li><a href="#program-options" class="table-of-contents__link toc-highlight">Program Options</a></li><li><a href="#diff-stats" class="table-of-contents__link toc-highlight">Diff Stats</a></li><li><a href="#strings" class="table-of-contents__link toc-highlight">Strings</a></li><li><a href="#kequeryspeculationcontrolinformation" class="table-of-contents__link toc-highlight">KeQuerySpeculationControlInformation</a><ul><li><a href="#match-info" class="table-of-contents__link toc-highlight">Match Info</a></li><li><a href="#function-meta-diff" class="table-of-contents__link toc-highlight">Function Meta Diff</a></li><li><a href="#kequeryspeculationcontrolinformation-diff" class="table-of-contents__link toc-highlight">KeQuerySpeculationControlInformation Diff</a></li></ul></li><li><a href="#micreatefixuprecord" class="table-of-contents__link toc-highlight">MiCreateFixupRecord</a><ul><li><a href="#match-info-1" class="table-of-contents__link toc-highlight">Match Info</a></li><li><a href="#function-meta-diff-1" class="table-of-contents__link toc-highlight">Function Meta Diff</a></li><li><a href="#micreatefixuprecord-diff" class="table-of-contents__link toc-highlight">MiCreateFixupRecord Diff</a></li></ul></li><li><a href="#kisethardwarespeculationcontrolfeatures" class="table-of-contents__link toc-highlight">KiSetHardwareSpeculationControlFeatures</a><ul><li><a href="#match-info-2" class="table-of-contents__link toc-highlight">Match Info</a></li><li><a href="#function-meta-diff-2" class="table-of-contents__link toc-highlight">Function Meta Diff</a></li><li><a href="#kisethardwarespeculationcontrolfeatures-diff" class="table-of-contents__link toc-highlight">KiSetHardwareSpeculationControlFeatures Diff</a></li></ul></li><li><a href="#kidetecthardwarespeccontrolfeatures" class="table-of-contents__link toc-highlight">KiDetectHardwareSpecControlFeatures</a><ul><li><a href="#match-info-3" class="table-of-contents__link toc-highlight">Match Info</a></li><li><a href="#function-meta-diff-3" class="table-of-contents__link toc-highlight">Function Meta Diff</a></li><li><a href="#kidetecthardwarespeccontrolfeatures-diff" class="table-of-contents__link toc-highlight">KiDetectHardwareSpecControlFeatures Diff</a></li></ul></li><li><a href="#mikvarangesort" class="table-of-contents__link toc-highlight">MiKvaRangeSort</a><ul><li><a href="#match-info-4" class="table-of-contents__link toc-highlight">Match Info</a></li><li><a href="#function-meta-diff-4" class="table-of-contents__link toc-highlight">Function Meta Diff</a></li><li><a href="#mikvarangesort-calling-diff" class="table-of-contents__link toc-highlight">MiKvaRangeSort Calling Diff</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ghidriff/docs/ghidriff">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://infosec.exchange/@clearbluejar" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastadon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/clearbluejar" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://clearbluejar.github.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/clearbluejar/ghidriff" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 ghidriff. Built with Python, Ghidra, and Markdown</div></div></div></footer></div>
</body>
</html>